<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Federico Jose Rodriguez">
<meta name="dcterms.date" content="2024-09-23">

<title>Discovering Impact of COVID-19 on Thai Tourism Economy – Geospatial Analytics w/ Derek</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>

<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>

<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>



<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Geospatial Analytics w/ Derek</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-Class Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take Home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#a.-getting-started" id="toc-a.-getting-started" class="nav-link active" data-scroll-target="#a.-getting-started">A. Getting Started</a>
  <ul class="collapse">
  <li><a href="#a.1-background" id="toc-a.1-background" class="nav-link" data-scroll-target="#a.1-background">A.1 Background</a></li>
  <li><a href="#a.2-objectives" id="toc-a.2-objectives" class="nav-link" data-scroll-target="#a.2-objectives">A.2 Objectives</a></li>
  <li><a href="#a.3-data-sources" id="toc-a.3-data-sources" class="nav-link" data-scroll-target="#a.3-data-sources">A.3 Data Sources</a></li>
  <li><a href="#a.4-importing-and-launching-r-packages" id="toc-a.4-importing-and-launching-r-packages" class="nav-link" data-scroll-target="#a.4-importing-and-launching-r-packages">A.4 Importing and Launching R Packages</a></li>
  </ul></li>
  <li><a href="#b.-data-loading-and-preparation" id="toc-b.-data-loading-and-preparation" class="nav-link" data-scroll-target="#b.-data-loading-and-preparation">B. Data Loading and Preparation</a>
  <ul class="collapse">
  <li><a href="#b.1.-thailand-subnational-boundary-provincial-level" id="toc-b.1.-thailand-subnational-boundary-provincial-level" class="nav-link" data-scroll-target="#b.1.-thailand-subnational-boundary-provincial-level">B.1. Thailand Subnational Boundary, Provincial Level</a></li>
  <li><a href="#b.2.-thailand-tourism-data-by-province-jan-2019---feb-2023" id="toc-b.2.-thailand-tourism-data-by-province-jan-2019---feb-2023" class="nav-link" data-scroll-target="#b.2.-thailand-tourism-data-by-province-jan-2019---feb-2023">B.2. Thailand Tourism Data by Province, Jan 2019 - Feb 2023</a></li>
  </ul></li>
  <li><a href="#c.-exploratory-data-analysis" id="toc-c.-exploratory-data-analysis" class="nav-link" data-scroll-target="#c.-exploratory-data-analysis">C. Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#c.1-tourism-revenue" id="toc-c.1-tourism-revenue" class="nav-link" data-scroll-target="#c.1-tourism-revenue">C.1 Tourism Revenue</a></li>
  <li><a href="#c.2-number-of-tourists" id="toc-c.2-number-of-tourists" class="nav-link" data-scroll-target="#c.2-number-of-tourists">C.2 Number of Tourists</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Discovering Impact of COVID-19 on Thai Tourism Economy</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Federico Jose Rodriguez </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 23, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 8, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<p>(Exercise Summary)</p>
<section id="a.-getting-started" class="level1">
<h1>A. Getting Started</h1>
<section id="a.1-background" class="level2">
<h2 class="anchored" data-anchor-id="a.1-background">A.1 Background</h2>
<p>Tourism is a major industry in Thailand as it made up to 20% of their gross domestic product pre-pandemic. However, like the rest of the world, the industry has taken a hit with COVID-19 in 2020, and has slowly been recovering since 2021. Recent reports are stating that Thailand is already, but still, at 80% of its peak level in 2019.</p>
<p>While we speak about the industry in general, the state of tourism within Thailand, and their recovery status are not the same. For example, tourism revenues have been focused on Bangkok, Phuket and Chonburi pre-pandemic.</p>
<p>We are interested in understanding the state of tourism across Thailand with regards to its spatial distribution and time and space distribution– both in absolutes and in terms of the trend with respect to the pandemic.</p>
</section>
<section id="a.2-objectives" class="level2">
<h2 class="anchored" data-anchor-id="a.2-objectives">A.2 Objectives</h2>
<p>For this study, we want to understand the state of tourism in Thailand at a provincial level, and answer the following questions:</p>
<ol type="1">
<li><p>Are the key tourism indicators in Thailand (at a province level) independent from space and from space and time?</p></li>
<li><p>If tourism or any tourism indicators are not independent, what are the clusters, outliers and emerging hotspots and coldspots?</p></li>
</ol>
<p>We will use the appropriate packages in R in order to perform the different analysis (spatial and otherwise) to support our answers to the above questions.</p>
</section>
<section id="a.3-data-sources" class="level2">
<h2 class="anchored" data-anchor-id="a.3-data-sources">A.3 Data Sources</h2>
<p>The following data sources are used for this analysis:</p>
<ul>
<li><p><a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics">Thailand Domestic Tourism Statistics</a> from Kaggle covering the years 2019-2023 and are at province and month level across 8 indicators:</p>
<ol type="1">
<li><p><code>no_tourist_all</code> - total number of domestic tourists</p></li>
<li><p><code>no_tourist_foreign</code> - number of foreign tourists</p></li>
<li><p><code>no_tourist_occupied</code> - number of hotel rooms occupied</p></li>
<li><p><code>no_tourist_thai</code> - number of Thai tourists</p></li>
<li><p><code>occupancy_rate</code> - the percentage of occupied travel accommodations</p></li>
<li><p><code>revenue_all</code> - total tourism revenue, in M-THB (appears as net profit in the raw data)</p></li>
<li><p><code>revenue_foreign</code> - revenue generated by foreign tourists, in M-THB (appears as net profit in the raw data)</p></li>
<li><p><code>revenue_thai</code> - revenue generated by Thai tourists, in M-THB (appears as net profit in the raw data)</p></li>
</ol></li>
<li><p><a href="https://data.humdata.org/dataset/cod-ab-tha?">Thailand-Subnational Administrative Boundaries</a> from Human Data Exchange in shapefile format</p></li>
</ul>
</section>
<section id="a.4-importing-and-launching-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="a.4-importing-and-launching-r-packages">A.4 Importing and Launching R Packages</h2>
<p>For this study, the following R packages will be used. A description of the packages and the code, using <code>p_load()</code> of the <strong>pacman</strong> package, to import them is given below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Package Description</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Import Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The loaded packages include:</p>
<ul>
<li><p><strong>sf -</strong> package for importing, managing and processing vector-based geospatial data</p></li>
<li><p><strong>tidyverse -</strong> collection of packages for performing data importation, wrangling and visualization</p></li>
<li><p><strong>tmap -</strong> package with functions for plotting cartographic quality maps</p></li>
<li><p><strong>sfdep</strong> - for handling spatial data</p></li>
<li><p><strong>coorplot, ggpubr, heatmaply, factoextra</strong> - packages for multivariate data visualization and analysis</p></li>
<li><p><strong>cluster, ClustGeo, NbClust</strong> - packages for performing cluster analysis</p></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tmap, sfdep, tidyverse,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               ggpubr, heatmaply, factoextra,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               NbClust, cluster, ClustGeo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>As we will be performing simulations in the analysis later, it is good practice to define a random seed to be used so that results are consistent for viewers of this report, and the results can be reproduced.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="b.-data-loading-and-preparation" class="level1">
<h1>B. Data Loading and Preparation</h1>
<section id="b.1.-thailand-subnational-boundary-provincial-level" class="level2">
<h2 class="anchored" data-anchor-id="b.1.-thailand-subnational-boundary-provincial-level">B.1. Thailand Subnational Boundary, Provincial Level</h2>
<p>We load the Thailand subnational administrative boundary shapefile into an R dataframe using <code>st_read()</code> from the sf package. We need to analyze at the provincial level so we will be using the files suffixed by “1”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>thai_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial"</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer=</span><span class="st">"tha_admbnda_adm1_rtsd_20220121"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `tha_admbnda_adm1_rtsd_20220121' from data source 
  `C:\drkrodriguez\ISSS626-GAA\Take-home\Take-home_Ex02\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 77 features and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<p>The output states that the object is of multipolygon geometry type containing 77 features (provinces, records) across 16 fields. (columns) We can check the contents of the object using a number of methods. For the code chunk below, we use <code>glimpse()</code> which lists the columns, gives the data type and the first elements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(thai_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 77
Columns: 17
$ Shape_Leng &lt;dbl&gt; 2.417227, 1.695100, 1.251111, 1.884945, 3.041716, 1.739908,…
$ Shape_Area &lt;dbl&gt; 0.13133873, 0.07926199, 0.05323766, 0.12698345, 0.21393797,…
$ ADM1_EN    &lt;chr&gt; "Bangkok", "Samut Prakan", "Nonthaburi", "Pathum Thani", "P…
$ ADM1_TH    &lt;chr&gt; "กรุงเทพมหานคร", "สมุทรปราการ", "นนทบุรี", "ปทุมธานี", "พระนครศรีอ…
$ ADM1_PCODE &lt;chr&gt; "TH10", "TH11", "TH12", "TH13", "TH14", "TH15", "TH16", "TH…
$ ADM1_REF   &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ADM1ALT1EN &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ADM1ALT2EN &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ADM1ALT1TH &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ADM1ALT2TH &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ ADM0_EN    &lt;chr&gt; "Thailand", "Thailand", "Thailand", "Thailand", "Thailand",…
$ ADM0_TH    &lt;chr&gt; "ประเทศไทย", "ประเทศไทย", "ประเทศไทย", "ประเทศไทย", "ประเทศ…
$ ADM0_PCODE &lt;chr&gt; "TH", "TH", "TH", "TH", "TH", "TH", "TH", "TH", "TH", "TH",…
$ date       &lt;date&gt; 2019-02-18, 2019-02-18, 2019-02-18, 2019-02-18, 2019-02-18…
$ validOn    &lt;date&gt; 2022-01-22, 2022-01-22, 2022-01-22, 2022-01-22, 2022-01-22…
$ validTo    &lt;date&gt; -001-11-30, -001-11-30, -001-11-30, -001-11-30, -001-11-30…
$ geometry   &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((100.6139 13..., MULTIPOLYGON (…</code></pre>
</div>
</div>
<p>For clarity, we can clean up this dataframe by:</p>
<ol type="1">
<li>Keeping only relevant columns: The province name and code, geometry</li>
<li>Renaming the columns: change ADM1 to Province</li>
</ol>
<p>The following code chunk executes these steps by using <code>select()</code> for the first step and <code>rename()</code> for the second step. We again use <code>glimpse()</code> to give a preview of the dataset’s columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>thai_sf <span class="ot">&lt;-</span> thai_sf <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ADM1_EN, ADM1_PCODE, geometry) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Province =</span> ADM1_EN, <span class="at">ProvCode =</span> ADM1_PCODE)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(thai_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 77
Columns: 3
$ Province &lt;chr&gt; "Bangkok", "Samut Prakan", "Nonthaburi", "Pathum Thani", "Phr…
$ ProvCode &lt;chr&gt; "TH10", "TH11", "TH12", "TH13", "TH14", "TH15", "TH16", "TH17…
$ geometry &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((100.6139 13..., MULTIPOLYGON (((…</code></pre>
</div>
</div>
<p>We can check if there are any missing values by using <code>is.na()</code> and then check across each column using <code>colSums()</code> from <strong>Base R</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(thai_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Province ProvCode geometry 
       0        0        0 </code></pre>
</div>
</div>
<p>The output shows that there are no missing values for any of the retained columns.</p>
<p>Finally, we can quickly check if the object depicts Thailand properly by producing a quick map using <code>qtm()</code> from <strong>tmap</strong> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(thai_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="b.2.-thailand-tourism-data-by-province-jan-2019---feb-2023" class="level2">
<h2 class="anchored" data-anchor-id="b.2.-thailand-tourism-data-by-province-jan-2019---feb-2023">B.2. Thailand Tourism Data by Province, Jan 2019 - Feb 2023</h2>
<p>The code chunk below loads the tourism statistics data into a dataframe <code>tourism</code>. We use read_csv() to import the data from the file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/thailand_domestic_tourism_2019_2023.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 30800 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (5): province_thai, province_eng, region_thai, region_eng, variable
dbl  (1): value
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>We can check the contents by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tourism</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30,800 × 7
   date       province_thai province_eng   region_thai region_eng variable value
   &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
 1 2019-01-01 กรุงเทพมหานคร  Bangkok        ภาคกลาง     central    occupan…  93.4
 2 2019-01-01 ลพบุรี          Lopburi        ภาคกลาง     central    occupan…  61.3
 3 2019-01-01 พระนครศรีอยุธยา Phra Nakhon S… ภาคกลาง     central    occupan…  73.4
 4 2019-01-01 สระบุรี         Saraburi       ภาคกลาง     central    occupan…  67.3
 5 2019-01-01 ชัยนาท         Chainat        ภาคกลาง     central    occupan…  79.3
 6 2019-01-01 นครปฐม        Nakhon Pathom  ภาคกลาง     central    occupan…  71.7
 7 2019-01-01 สิงห์บุรี         Sing Buri      ภาคกลาง     central    occupan…  64.6
 8 2019-01-01 อ่างทอง        Ang Thong      ภาคกลาง     central    occupan…  71.2
 9 2019-01-01 นนทบุรี         Nonthaburi     ภาคกลาง     central    occupan…  75.1
10 2019-01-01 ปทุมธานี        Pathum Thani   ภาคกลาง     central    occupan…  60.8
# ℹ 30,790 more rows</code></pre>
</div>
</div>
<p>The imported data contains 7 fields and 30,800 records at a province and month level.</p>
<p>Before we analyze the dataset, let use remove unnecessary columns and rename the column names, similar to the previous dataset, using the code chunk below. (by using <code>select()</code> and <code>rename()</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, province_eng, region_eng, variable, value) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Date =</span> date, <span class="at">Province =</span> province_eng, <span class="at">Region =</span> region_eng, <span class="at">Indicator =</span> variable, <span class="at">Value =</span> value)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tourism)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Date       Province                 Region  Indicator      Value
  &lt;date&gt;     &lt;chr&gt;                    &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 2019-01-01 Bangkok                  central occupancy_rate  93.4
2 2019-01-01 Lopburi                  central occupancy_rate  61.3
3 2019-01-01 Phra Nakhon Si Ayutthaya central occupancy_rate  73.4
4 2019-01-01 Saraburi                 central occupancy_rate  67.3
5 2019-01-01 Chainat                  central occupancy_rate  79.3
6 2019-01-01 Nakhon Pathom            central occupancy_rate  71.7</code></pre>
</div>
</div>
<p>We have kept only five of the columns which provides the date, the English descriptions for the location (province and region) as well as the (potential) tourism indicator and its value.</p>
<p>We can also check for any missing values across these five columns using the code below. (using <code>is.na()</code> and <code>colSums()</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(tourism))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Date  Province    Region Indicator     Value 
        0         0         0         0         0 </code></pre>
</div>
</div>
<p>Each province will be repeated across multiple dates and across multiple indicators. Let us first doublecheck the different values in <code>Indicator</code>. We use <code>unique()</code> in the code chunk below to achieve this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(tourism<span class="sc">$</span>Indicator)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "occupancy_rate"      "no_tourist_occupied" "no_tourist_all"     
[4] "no_tourist_thai"     "no_tourist_foreign"  "net_profit_all"     
[7] "net_profit_thai"     "net_profit_foreign" </code></pre>
</div>
</div>
<p>We are aware that the ‘net_profit’ indicators are actually revenue so it is better to update them now to avoid misunderstanding later. We use <code>recode()</code> from <strong>dplyr</strong> to replace instances with alternative values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Indicator =</span> <span class="fu">recode</span>(Indicator,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"net_profit_all"</span> <span class="ot">=</span> <span class="st">"revenue_all"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"net_profit_thai"</span> <span class="ot">=</span> <span class="st">"revenue_thai"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"net_profit_foreign"</span> <span class="ot">=</span> <span class="st">"revenue_foreign"</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(tourism<span class="sc">$</span>Indicator)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "occupancy_rate"      "no_tourist_occupied" "no_tourist_all"     
[4] "no_tourist_thai"     "no_tourist_foreign"  "revenue_all"        
[7] "revenue_thai"        "revenue_foreign"    </code></pre>
</div>
</div>
<p>We will not define which indicators to use until we perform some EDA (Exploratory Data Analysis) in the next section.</p>
<p>Before we move to the next section, we will also introduce some columns into the dataset to make filtering and other analysis easier. For now, we will do this by adding columns for the months and years based on the <code>Date</code> column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MonthNum =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MonthYear =</span> <span class="fu">format</span>(<span class="fu">ymd</span>(Date), <span class="st">"%Y-%m"</span>))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tourism)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  Date       Province      Region Indicator Value  Year MonthNum Month MonthYear
  &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;ord&gt; &lt;chr&gt;    
1 2019-01-01 Bangkok       centr… occupanc…  93.4  2019        1 Jan   2019-01  
2 2019-01-01 Lopburi       centr… occupanc…  61.3  2019        1 Jan   2019-01  
3 2019-01-01 Phra Nakhon … centr… occupanc…  73.4  2019        1 Jan   2019-01  
4 2019-01-01 Saraburi      centr… occupanc…  67.3  2019        1 Jan   2019-01  
5 2019-01-01 Chainat       centr… occupanc…  79.3  2019        1 Jan   2019-01  
6 2019-01-01 Nakhon Pathom centr… occupanc…  71.7  2019        1 Jan   2019-01  </code></pre>
</div>
</div>
</section>
</section>
<section id="c.-exploratory-data-analysis" class="level1">
<h1>C. Exploratory Data Analysis</h1>
<p>We will use data analysis and visualization techniques to investigate the data before we perform the main analyses required. This allows us to get some insights on things like variables to use, provinces to focus on, deep dives to perform etc.</p>
<section id="c.1-tourism-revenue" class="level2">
<h2 class="anchored" data-anchor-id="c.1-tourism-revenue">C.1 Tourism Revenue</h2>
<p>We first look at tourism revenue which is currently reported in million Thai baht. We will use a constant rate of 34.784 THB per USD based on 2023 exchange rates to scale down the numbers and transform it into something more recognizable for most of the readers.</p>
<p>We first create a plot for the monthly tourism revenue in total and by foreign and local tourists. The code below selects the relevant data and prepares the line plot using <code>ggplot()</code>. Finally, we use <code>ggplotly()</code> to render it as an interactive chart so we can easily examine the resulting chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the data to just the required indicators</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>aggregated_data <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"revenue_all"</span>, <span class="st">"revenue_thai"</span>, <span class="st">"revenue_foreign"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MonthYear, Indicator) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalValue =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fl">34.784</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'MonthYear'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the line chart</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aggregated_data, <span class="fu">aes</span>(<span class="at">x =</span> MonthYear, <span class="at">y =</span> TotalValue, <span class="at">color =</span> Indicator, <span class="at">group =</span> Indicator)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Thai Tourism Revenue by Month"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Million USD"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month-Year"</span>) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"revenue_all"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"revenue_thai"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"revenue_foreign"</span> <span class="ot">=</span> <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot chart to an interactive plotly chart</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the interactive plot</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>interactive_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-1b4ff99564eb6e8884a5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1b4ff99564eb6e8884a5">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[7404.551230450782,6647.8832221711136,6703.2313707451704,6542.9162833486662,5924.8769549218032,5597.7394779208835,5853.1212626494944,5719.1021734130636,5590.7831186752528,6943.156911223552,7034.1904323827048,8462.5459981600743,7768.1741605335783,4298.9020814167434,1371.7907658693653,287.93065777368906,309.05330036798529,534.57940432382713,1057.0221941122354,1167.5252989880405,1224.1723206071758,1412.4350275988961,1728.836246550138,1624.0257014719411,692.0434682612696,885.64799908003681,1073.6260924563019,823.55134544618215,121.80197792088317,108.84717111315548,98.459061637534504,97.671630634774601,211.62431002759891,366.84308877644895,884.24994250229997,1574.175482980681,1646.5139144434224,1634.9675137994479,1748.4636614535418,1941.9123735050598,2073.9104185832566,2326.4224931002759,2804.0196642134315,2887.9240455381787,2882.8449862005523,3114.4181232750689,3764.117985280589,4354.7766214351432,4709.7947332106714,4707.1294273229078],"text":["MonthYear: 2019-01<br />TotalValue: 7404.55123<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-02<br />TotalValue: 6647.88322<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-03<br />TotalValue: 6703.23137<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-04<br />TotalValue: 6542.91628<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-05<br />TotalValue: 5924.87695<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-06<br />TotalValue: 5597.73948<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-07<br />TotalValue: 5853.12126<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-08<br />TotalValue: 5719.10217<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-09<br />TotalValue: 5590.78312<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-10<br />TotalValue: 6943.15691<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-11<br />TotalValue: 7034.19043<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2019-12<br />TotalValue: 8462.54600<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-01<br />TotalValue: 7768.17416<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-02<br />TotalValue: 4298.90208<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-03<br />TotalValue: 1371.79077<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-04<br />TotalValue:  287.93066<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-05<br />TotalValue:  309.05330<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-06<br />TotalValue:  534.57940<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-07<br />TotalValue: 1057.02219<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-08<br />TotalValue: 1167.52530<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-09<br />TotalValue: 1224.17232<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-10<br />TotalValue: 1412.43503<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-11<br />TotalValue: 1728.83625<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2020-12<br />TotalValue: 1624.02570<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-01<br />TotalValue:  692.04347<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-02<br />TotalValue:  885.64800<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-03<br />TotalValue: 1073.62609<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-04<br />TotalValue:  823.55135<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-05<br />TotalValue:  121.80198<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-06<br />TotalValue:  108.84717<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-07<br />TotalValue:   98.45906<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-08<br />TotalValue:   97.67163<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-09<br />TotalValue:  211.62431<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-10<br />TotalValue:  366.84309<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-11<br />TotalValue:  884.24994<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2021-12<br />TotalValue: 1574.17548<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-01<br />TotalValue: 1646.51391<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-02<br />TotalValue: 1634.96751<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-03<br />TotalValue: 1748.46366<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-04<br />TotalValue: 1941.91237<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-05<br />TotalValue: 2073.91042<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-06<br />TotalValue: 2326.42249<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-07<br />TotalValue: 2804.01966<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-08<br />TotalValue: 2887.92405<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-09<br />TotalValue: 2882.84499<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-10<br />TotalValue: 3114.41812<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-11<br />TotalValue: 3764.11799<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2022-12<br />TotalValue: 4354.77662<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2023-01<br />TotalValue: 4709.79473<br />Indicator: revenue_all<br />Indicator: revenue_all","MonthYear: 2023-02<br />TotalValue: 4707.12943<br />Indicator: revenue_all<br />Indicator: revenue_all"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,0,255,1)","dash":"solid"},"hoveron":"points","name":"revenue_all","legendgroup":"revenue_all","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[4685.9329001839924,4135.6022884084641,4199.4776333946647,3953.8747700091994,3467.407428702852,3359.7820837166514,3187.2038868445261,3208.5867065317389,3013.3710901563941,4274.3468261269554,4290.9047263109478,5548.2782313707448,5069.7171113155482,2400.3360740570379,530.58187672493102,273.56974471021164,247.55031048758053,72.96745630174793,50.979185832566699,39.686350045998161,35.180542778288867,56.119480220791168,76.595273689052433,60.760982060717581,34.322102115915364,36.586649034038643,41.728380864765413,37.670193192272308,13.527771389144435,11.155416283348666,35.797493100275993,34.476483440662378,53.51454691812328,68.854645814167441,109.29766559337627,241.05077046918126,274.12143514259435,269.19129484820604,337.67738040478383,388.30755519779206,641.59067387304515,902.72711591536347,1298.5545078196872,1373.9265179392823,1366.063132474701,1516.3089351425945,2016.1033808647655,2351.7746665133395,2687.9188707451699,2909.1277598896045],"text":["MonthYear: 2019-01<br />TotalValue: 4685.93290<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-02<br />TotalValue: 4135.60229<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-03<br />TotalValue: 4199.47763<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-04<br />TotalValue: 3953.87477<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-05<br />TotalValue: 3467.40743<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-06<br />TotalValue: 3359.78208<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-07<br />TotalValue: 3187.20389<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-08<br />TotalValue: 3208.58671<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-09<br />TotalValue: 3013.37109<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-10<br />TotalValue: 4274.34683<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-11<br />TotalValue: 4290.90473<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2019-12<br />TotalValue: 5548.27823<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-01<br />TotalValue: 5069.71711<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-02<br />TotalValue: 2400.33607<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-03<br />TotalValue:  530.58188<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-04<br />TotalValue:  273.56974<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-05<br />TotalValue:  247.55031<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-06<br />TotalValue:   72.96746<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-07<br />TotalValue:   50.97919<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-08<br />TotalValue:   39.68635<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-09<br />TotalValue:   35.18054<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-10<br />TotalValue:   56.11948<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-11<br />TotalValue:   76.59527<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2020-12<br />TotalValue:   60.76098<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-01<br />TotalValue:   34.32210<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-02<br />TotalValue:   36.58665<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-03<br />TotalValue:   41.72838<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-04<br />TotalValue:   37.67019<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-05<br />TotalValue:   13.52777<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-06<br />TotalValue:   11.15542<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-07<br />TotalValue:   35.79749<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-08<br />TotalValue:   34.47648<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-09<br />TotalValue:   53.51455<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-10<br />TotalValue:   68.85465<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-11<br />TotalValue:  109.29767<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2021-12<br />TotalValue:  241.05077<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-01<br />TotalValue:  274.12144<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-02<br />TotalValue:  269.19129<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-03<br />TotalValue:  337.67738<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-04<br />TotalValue:  388.30756<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-05<br />TotalValue:  641.59067<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-06<br />TotalValue:  902.72712<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-07<br />TotalValue: 1298.55451<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-08<br />TotalValue: 1373.92652<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-09<br />TotalValue: 1366.06313<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-10<br />TotalValue: 1516.30894<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-11<br />TotalValue: 2016.10338<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2022-12<br />TotalValue: 2351.77467<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2023-01<br />TotalValue: 2687.91887<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign","MonthYear: 2023-02<br />TotalValue: 2909.12776<br />Indicator: revenue_foreign<br />Indicator: revenue_foreign"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","name":"revenue_foreign","legendgroup":"revenue_foreign","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[2718.6183302667891,2512.2809337626495,2503.7537373505061,2589.0415133394667,2457.4695262189512,2237.9573942042321,2665.9173758049678,2510.5154668813248,2577.4120285188592,2668.8100850965961,2743.285706071757,2914.2677667893286,2698.4570492180314,1898.5660073597057,841.20888914443424,14.360913063477462,61.50298988040479,461.6119480220791,1006.0430082796688,1127.8389489420424,1188.9917778288868,1356.3155473781051,1652.2409728610858,1563.2647194112235,657.72136614535418,849.06135004599821,1031.8977115915363,785.88115225390982,108.27420653173874,97.691754829806811,62.661568537258511,63.195147194112231,158.10947562097516,297.98815547378103,774.95227690892364,1333.1247125114996,1372.3924793008282,1365.7762189512418,1410.7862810487582,1553.6048183072678,1432.3197447102116,1423.6953771849126,1505.4651563937443,1513.9975275988961,1516.7818537258509,1598.1091881324746,1748.0146044158234,2003.0019549218032,2021.8758624655013,1798.0016674333028],"text":["MonthYear: 2019-01<br />TotalValue: 2718.61833<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-02<br />TotalValue: 2512.28093<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-03<br />TotalValue: 2503.75374<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-04<br />TotalValue: 2589.04151<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-05<br />TotalValue: 2457.46953<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-06<br />TotalValue: 2237.95739<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-07<br />TotalValue: 2665.91738<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-08<br />TotalValue: 2510.51547<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-09<br />TotalValue: 2577.41203<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-10<br />TotalValue: 2668.81009<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-11<br />TotalValue: 2743.28571<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2019-12<br />TotalValue: 2914.26777<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-01<br />TotalValue: 2698.45705<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-02<br />TotalValue: 1898.56601<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-03<br />TotalValue:  841.20889<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-04<br />TotalValue:   14.36091<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-05<br />TotalValue:   61.50299<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-06<br />TotalValue:  461.61195<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-07<br />TotalValue: 1006.04301<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-08<br />TotalValue: 1127.83895<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-09<br />TotalValue: 1188.99178<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-10<br />TotalValue: 1356.31555<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-11<br />TotalValue: 1652.24097<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2020-12<br />TotalValue: 1563.26472<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-01<br />TotalValue:  657.72137<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-02<br />TotalValue:  849.06135<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-03<br />TotalValue: 1031.89771<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-04<br />TotalValue:  785.88115<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-05<br />TotalValue:  108.27421<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-06<br />TotalValue:   97.69175<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-07<br />TotalValue:   62.66157<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-08<br />TotalValue:   63.19515<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-09<br />TotalValue:  158.10948<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-10<br />TotalValue:  297.98816<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-11<br />TotalValue:  774.95228<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2021-12<br />TotalValue: 1333.12471<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-01<br />TotalValue: 1372.39248<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-02<br />TotalValue: 1365.77622<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-03<br />TotalValue: 1410.78628<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-04<br />TotalValue: 1553.60482<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-05<br />TotalValue: 1432.31974<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-06<br />TotalValue: 1423.69538<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-07<br />TotalValue: 1505.46516<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-08<br />TotalValue: 1513.99753<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-09<br />TotalValue: 1516.78185<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-10<br />TotalValue: 1598.10919<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-11<br />TotalValue: 1748.01460<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2022-12<br />TotalValue: 2003.00195<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2023-01<br />TotalValue: 2021.87586<br />Indicator: revenue_thai<br />Indicator: revenue_thai","MonthYear: 2023-02<br />TotalValue: 1798.00167<br />Indicator: revenue_thai<br />Indicator: revenue_thai"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,255,0,1)","dash":"solid"},"hoveron":"points","name":"revenue_thai","legendgroup":"revenue_thai","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":69.406392694063939,"l":48.949771689497723},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Thai Tourism Revenue by Month","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,50.600000000000001],"tickmode":"array","ticktext":["2019-01","2019-02","2019-03","2019-04","2019-05","2019-06","2019-07","2019-08","2019-09","2019-10","2019-11","2019-12","2020-01","2020-02","2020-03","2020-04","2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02"],"tickvals":[1,2,3,3.9999999999999996,5,6,7,8,9,10,11,12,13.000000000000002,14,15,16,17,18,19,20,21,22,23,24,25,26,27,27.999999999999996,29.000000000000004,30.000000000000004,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"categoryorder":"array","categoryarray":["2019-01","2019-02","2019-03","2019-04","2019-05","2019-06","2019-07","2019-08","2019-09","2019-10","2019-11","2019-12","2020-01","2020-02","2020-03","2020-04","2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Month-Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-411.41411281048767,8885.1155272539108],"tickmode":"array","ticktext":["0","2000","4000","6000","8000"],"tickvals":[0,1999.9999999999993,4000,6000,8000],"categoryorder":"array","categoryarray":["0","2000","4000","6000","8000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Million USD","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Indicator","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"a05c18961160":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"a05c18961160","visdat":{"a05c18961160":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The resulting chart is consistent with the expectation on the impact and recovery from the pandemic. We can view the above chart as a timeline:</p>
<ol type="1">
<li><p>Up to (mid)January 2020: Pre-covid. No travel restrictions have been set yet. (Jan 2019 - Jan 2020, 13 months)</p></li>
<li><p>Feb 2020 to November 2021: Covid. Various lockdown measures in place. All foreign non-essential travel is banned. There is some local tourist activity, but another set of measures in May 2021 again prevents non-essential movement (Feb 2020 - Oct 2021, 22 months)</p></li>
<li><p>November 2021 onwards: Post-Covid. Travel restrictions have been eased or lifted and tourism revenues have been recovering (Nov 2021 - Feb 2023, 16 months)</p></li>
</ol>
<p>Pre- and post-covid, we see that foreign tourists contribute more to the overall revenue, and their contribution has a large amount of variance. Local tourists during the same period have contributed a more stable amount month-on-month. As there is lower contribution and less variance for local tourists, we will exclude them from the analysis, and focus on total and foreign numbers for now.</p>
<p>We can code the three periods mentioned above into the tourism dataset for convenience. We use the <code>ifelse()</code> function to do this based on the cutoff dates mentioned above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>tourism<span class="sc">$</span>Period <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tourism<span class="sc">$</span>Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">"2020-02-01"</span>), <span class="st">"Pre-Covid"</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ifelse</span>(tourism<span class="sc">$</span>Date <span class="sc">&gt;</span> <span class="fu">as.Date</span>(<span class="st">"2021-10-01"</span>), <span class="st">"Post-Covid"</span>, <span class="st">"Covid"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can next check the tourism revenue at the province level. As plotting all 77 provinces across all the periods will not produce readable charts, we will focus on top 20 provinces for the different periods. We will also take the average monthly revenue rather than the total since each period has a different number of months.</p>
<p>We prepare a new dataframe that summarizes the indicators for each province in <code>tourism</code>. Aside from the average revenue per period, we will also compute for the average number of visitors as well as the average spend per visitor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>tourism_period <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Province) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_Revenue_total =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Pre-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_all"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">13</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Covid_Revenue_total =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_all"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">22</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_Revenue_total =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Post-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_all"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">16</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_Revenue_foreign =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Pre-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_foreign"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">13</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Covid_Revenue_foreign =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_foreign"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">22</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_Revenue_foreign =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Post-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"revenue_foreign"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">16</span><span class="sc">/</span><span class="fl">34.784</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_tourists_total =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Pre-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_all"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">13</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Covid_tourists_total =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_all"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">22</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_tourists_total =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Post-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_all"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">16</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">PreCovid_tourists_foreign =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Pre-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_foreign"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">13</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Covid_tourists_foreign =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_foreign"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">22</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostCovid_tourists_foreign =</span> <span class="fu">sum</span>(Value[Period <span class="sc">==</span> <span class="st">"Post-Covid"</span> <span class="sc">&amp;</span> Indicator <span class="sc">==</span> <span class="st">"no_tourist_foreign"</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">16</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PreCovidSpend_total =</span> PreCovid_Revenue_total <span class="sc">/</span> PreCovid_tourists_total) <span class="sc">%&gt;%</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CovidSpend_total =</span> Covid_Revenue_total <span class="sc">/</span> Covid_tourists_total) <span class="sc">%&gt;%</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PostCovidSpend_total =</span> PostCovid_Revenue_total <span class="sc">/</span> PostCovid_tourists_total) <span class="sc">%&gt;%</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PreCovidSpend_foreign =</span> PreCovid_Revenue_foreign <span class="sc">/</span> PreCovid_tourists_foreign) <span class="sc">%&gt;%</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CovidSpend_foreign =</span> Covid_Revenue_foreign <span class="sc">/</span> Covid_tourists_foreign) <span class="sc">%&gt;%</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">PostCovidSpend_foreign =</span> PostCovid_Revenue_foreign <span class="sc">/</span> PostCovid_tourists_foreign)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With the summarized dataframe prepared, we can now prepare a few visualizations to look at the provinces with regards to the average monthly tourism revenue.</p>
<p>First, let us try using a scatterplot to see both the average revenue pre-Covid (x-axis) and post-Covid. (y-axis) Provinces with the highest pre-Covid revenue will appear the rightmost, while those that have the highest post-Covid revenue will appear the rightmost.</p>
<p>The code below uses the <strong>plotly</strong> package to produce an interactive scatterplot of the pre- and post-covid average monthly revenue for all tourists. With the interactive chart, the province names will be visible by hovering over and the user can zoom in by creating a selection in the chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tourism_period,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>PreCovid_Revenue_total,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PostCovid_Revenue_total,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span>Province,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Monthly Pre- and Post-Covid Revenue - M-USD'</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Average PreCovid Revenue'</span>),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Average PostCovid Revenue'</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8f836166d559454ecd73" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8f836166d559454ecd73">{"x":{"visdat":{"a05c4cf13bc3":["function () ","plotlyVisDat"]},"cur_data":"a05c4cf13bc3","attrs":{"a05c4cf13bc3":{"x":{},"y":{},"mode":"markers","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Pre- and Post-Covid Revenue - M-USD","xaxis":{"domain":[0,1],"automargin":true,"title":"Average PreCovid Revenue"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average PostCovid Revenue"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1.044489951171184,2.5197040195315261,2556.4730247328571,2.6724046422758474,11.151103955841768,11.902576781544123,3.1590342155544548,5.2664133819262604,21.48308683037294,269.26214970631946,71.583884721534218,670.93798651900067,17.791822942466915,2.9335990021937586,4.0035206284056333,67.755687849409114,43.709242976434787,275.459981600736,10.34779474205647,4.1098692590757908,11.296949083575118,13.632461432311938,13.053747080885996,2.8713466845941547,8.6995347109192558,18.72797395796476,14.557488854291982,5.2922210034675539,60.2045591253273,9.5790062628264092,37.98855353478168,6.7776298563442081,7.5188857830302176,0.97896468756634358,13.790889710565425,11.334698535135518,8.3651413558842265,2.4849400254759044,127.95832301323333,7.977628971764207,3.4318608024909771,18.914730910763573,73.571889816715029,3.6102584742764137,21.067577489208126,45.59271282994834,4.3052066378883307,1117.5767594296228,12.803521512985634,101.51112801641781,10.68908782110254,10.739464652183145,87.236461503078345,3.459415469535065,16.235448658976718,5.9936929445899096,17.150436097940698,5.8733237208973179,7.5416194890665915,15.773697898237916,24.101244604061989,2.0773476753237565,5.4028377326445405,163.03200852735122,9.3096737668954788,13.680803729389288,230.30038125398065,7.6925951808081523,17.726054419361684,23.879414054207061,47.801155261481853,19.73535577807657,27.015537647724859,3.3044370532870992,5.5109997523175993,7.8912276201259646,1.9771247611633997],"y":[0.58723119825206993,1.6386485165593376,858.20608972516106,2.1284390811867526,13.347156738730451,12.486739592916283,2.3871607635694572,3.4923923355565778,12.764597228610855,153.95663235970562,84.04591550712972,252.66478481485743,7.3711692157313715,1.5597508912143514,3.1448726425942963,52.469598091076357,22.504132647194112,38.613874195032203,10.388900068997241,3.3636513914443422,7.8382661568537264,10.650155243790248,10.388864132934682,1.3875991835326587,5.3983153173873051,8.3257568134774598,8.7321038408463671,5.2909922665593383,24.850110683072678,9.8594540593376276,13.210509860855566,7.8337202449402037,1.9001552437902485,0.48770627299908004,8.1421774379024843,7.7217075379484825,5.0943321642134309,1.2514015064397426,15.858853927092916,1.7753133624655013,4.4658823022079117,16.295207566697332,57.593325954461825,2.5439138684452622,15.010098033578659,28.739273085326587,5.631935660073597,482.14744925827972,6.680064828656854,78.676636528288881,2.7050871090156394,4.9792828599356032,26.574790133394668,1.9619832394204233,8.2059998850045996,4.9440834866605332,8.1585822504599808,1.8567624482520702,10.573270037948483,14.527692329806808,13.754258423413065,1.7665629312327507,2.3747987580496783,36.995044416973322,5.1224521331646731,11.93388123850046,63.938017479300832,3.6437011269549222,11.831104099586016,8.6348967916283357,21.415701184452622,7.6614966651333951,14.651851425942962,2.952884228380865,3.0800080496780131,4.8531113442962281,0.97726325321987118],"mode":"markers","text":["Amnat Charoen","Ang Thong","Bangkok","Bueng Kan","Buriram","Chachoengsao","Chainat","Chaiyaphum","Chanthaburi","Chiang Mai","Chiang Rai","Chonburi","Chumphon","Kalasin","Kamphaeng Phet","Kanchanaburi","Khon Kaen","Krabi","Lampang","Lamphun","Loei","Lopburi","Mae Hong Son","Maha Sarakham","Mukdahan","Nakhon Nayok","Nakhon Pathom","Nakhon Phanom","Nakhon Ratchasima","Nakhon Sawan","Nakhon Si Thammarat","Nan","Narathiwat","Nong Bua Lamphu","Nong Khai","Nonthaburi","Pathum Thani","Pattani","Phang Nga","Phatthalung","Phayao","Phetchabun","Phetchaburi","Phichit","Phitsanulok","Phra Nakhon Si Ayutthaya","Phrae","Phuket","Prachinburi","Prachuap Khiri Khan","Ranong","Ratchaburi","Rayong","Roi Et","Sa Kaeo","Sakon Nakhon","Samut Prakan","Samut Sakhon","Samut Songkhram","Saraburi","Satun","Sing Buri","Sisaket","Songkhla","Sukhothai","Suphan Buri","Surat Thani","Surin","Tak","Trang","Trat","Ubon Ratchathani","Udon Thani","Uthai Thani","Uttaradit","Yala","Yasothon"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Baed on the plot, we see that Bangkok, Phuket and Chonburi have consistently been the top 3 highest revenue generating before and after the pandemic. When we look further down the list, we see some shifts for some of the provinces.</p>
<p>To aid the reader, we recreate the chart with those top 3 provinces excluded using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(tourism_period, <span class="sc">!</span>(Province <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Bangkok"</span>, <span class="st">"Phuket"</span>, <span class="st">"Chonburi"</span>))),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>PreCovid_Revenue_total,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PostCovid_Revenue_total,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span>Province,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Monthly Pre- and Post-Covid Revenue - M-USD, exc Top 3 Provinces'</span>,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Average PreCovid Revenue'</span>),</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Average PostCovid Revenue'</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-0d7db73d03839427d3b7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0d7db73d03839427d3b7">{"x":{"visdat":{"a05c68ae4e14":["function () ","plotlyVisDat"]},"cur_data":"a05c68ae4e14","attrs":{"a05c68ae4e14":{"x":{},"y":{},"mode":"markers","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Pre- and Post-Covid Revenue - M-USD, exc Top 3 Provinces","xaxis":{"domain":[0,1],"automargin":true,"title":"Average PreCovid Revenue"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average PostCovid Revenue"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1.044489951171184,2.5197040195315261,2.6724046422758474,11.151103955841768,11.902576781544123,3.1590342155544548,5.2664133819262604,21.48308683037294,269.26214970631946,71.583884721534218,17.791822942466915,2.9335990021937586,4.0035206284056333,67.755687849409114,43.709242976434787,275.459981600736,10.34779474205647,4.1098692590757908,11.296949083575118,13.632461432311938,13.053747080885996,2.8713466845941547,8.6995347109192558,18.72797395796476,14.557488854291982,5.2922210034675539,60.2045591253273,9.5790062628264092,37.98855353478168,6.7776298563442081,7.5188857830302176,0.97896468756634358,13.790889710565425,11.334698535135518,8.3651413558842265,2.4849400254759044,127.95832301323333,7.977628971764207,3.4318608024909771,18.914730910763573,73.571889816715029,3.6102584742764137,21.067577489208126,45.59271282994834,4.3052066378883307,12.803521512985634,101.51112801641781,10.68908782110254,10.739464652183145,87.236461503078345,3.459415469535065,16.235448658976718,5.9936929445899096,17.150436097940698,5.8733237208973179,7.5416194890665915,15.773697898237916,24.101244604061989,2.0773476753237565,5.4028377326445405,163.03200852735122,9.3096737668954788,13.680803729389288,230.30038125398065,7.6925951808081523,17.726054419361684,23.879414054207061,47.801155261481853,19.73535577807657,27.015537647724859,3.3044370532870992,5.5109997523175993,7.8912276201259646,1.9771247611633997],"y":[0.58723119825206993,1.6386485165593376,2.1284390811867526,13.347156738730451,12.486739592916283,2.3871607635694572,3.4923923355565778,12.764597228610855,153.95663235970562,84.04591550712972,7.3711692157313715,1.5597508912143514,3.1448726425942963,52.469598091076357,22.504132647194112,38.613874195032203,10.388900068997241,3.3636513914443422,7.8382661568537264,10.650155243790248,10.388864132934682,1.3875991835326587,5.3983153173873051,8.3257568134774598,8.7321038408463671,5.2909922665593383,24.850110683072678,9.8594540593376276,13.210509860855566,7.8337202449402037,1.9001552437902485,0.48770627299908004,8.1421774379024843,7.7217075379484825,5.0943321642134309,1.2514015064397426,15.858853927092916,1.7753133624655013,4.4658823022079117,16.295207566697332,57.593325954461825,2.5439138684452622,15.010098033578659,28.739273085326587,5.631935660073597,6.680064828656854,78.676636528288881,2.7050871090156394,4.9792828599356032,26.574790133394668,1.9619832394204233,8.2059998850045996,4.9440834866605332,8.1585822504599808,1.8567624482520702,10.573270037948483,14.527692329806808,13.754258423413065,1.7665629312327507,2.3747987580496783,36.995044416973322,5.1224521331646731,11.93388123850046,63.938017479300832,3.6437011269549222,11.831104099586016,8.6348967916283357,21.415701184452622,7.6614966651333951,14.651851425942962,2.952884228380865,3.0800080496780131,4.8531113442962281,0.97726325321987118],"mode":"markers","text":["Amnat Charoen","Ang Thong","Bueng Kan","Buriram","Chachoengsao","Chainat","Chaiyaphum","Chanthaburi","Chiang Mai","Chiang Rai","Chumphon","Kalasin","Kamphaeng Phet","Kanchanaburi","Khon Kaen","Krabi","Lampang","Lamphun","Loei","Lopburi","Mae Hong Son","Maha Sarakham","Mukdahan","Nakhon Nayok","Nakhon Pathom","Nakhon Phanom","Nakhon Ratchasima","Nakhon Sawan","Nakhon Si Thammarat","Nan","Narathiwat","Nong Bua Lamphu","Nong Khai","Nonthaburi","Pathum Thani","Pattani","Phang Nga","Phatthalung","Phayao","Phetchabun","Phetchaburi","Phichit","Phitsanulok","Phra Nakhon Si Ayutthaya","Phrae","Prachinburi","Prachuap Khiri Khan","Ranong","Ratchaburi","Rayong","Roi Et","Sa Kaeo","Sakon Nakhon","Samut Prakan","Samut Sakhon","Samut Songkhram","Saraburi","Satun","Sing Buri","Sisaket","Songkhla","Sukhothai","Suphan Buri","Surat Thani","Surin","Tak","Trang","Trat","Ubon Ratchathani","Udon Thani","Uthai Thani","Uttaradit","Yala","Yasothon"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Some key observations from the above charts are:</p>
<ol type="1">
<li><p>Chiang Mai has moved from top 5 to top 4. A large reason for this is a drop from Krabi. Pre-covid, Krabi was top 4, but has dropped to at least top 10.</p></li>
<li><p>Chiang Rai and Prachuap Khiri Khan have risen to top 5 and 6. These provinces were top 9 or lower before.</p></li>
<li><p>Songkhla and Phang Nga were in the top 10 pre-Covid but are also showing a drop in ranking post-Covid</p></li>
</ol>
<p>We can do the same chart for just the revenue from foreign tourists using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tourism_period,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>PreCovid_Revenue_foreign,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PostCovid_Revenue_foreign,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span>Province,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Monthly Pre- and Post-Covid Revenue from Foreign Tourists - M-USD'</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Average PreCovid Revenue'</span>),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Average PostCovid Revenue'</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c2e3fede5c798441fdae" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c2e3fede5c798441fdae">{"x":{"visdat":{"a05c5dc47a0":["function () ","plotlyVisDat"]},"cur_data":"a05c5dc47a0","attrs":{"a05c5dc47a0":{"x":{},"y":{},"mode":"markers","text":{},"hoverinfo":"text","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Monthly Pre- and Post-Covid Revenue from Foreign Tourists - M-USD","xaxis":{"domain":[0,1],"automargin":true,"title":"Average PreCovid Revenue"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average PostCovid Revenue"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0.067913629608661819,0.090448305144717286,1637.080045644328,0.030783384049253414,0.67451436557922306,0.14261641072818626,0.019748248531597196,0.056038143089661034,1.3089572570943317,105.21198959733917,16.250154801500248,539.51772698322839,1.738288160781261,0.024126919538603072,0.1258536197013658,5.6028854999646169,0.7734546387375274,183.90878211025407,1.3336812681338903,0.19757094331611352,0.30447243648715594,0.11077153067723447,5.0192617295308191,0.044295343570872552,0.9131298209610077,0.23978752388366006,0.63320447951312708,0.28839519496143234,2.0591253272946006,0.20232556082372088,0.88230220791168346,0.2463113013940981,5.2460901563937439,0.0054622815087396505,2.1374327719198924,1.5785551270256881,3.2074207416318732,0.024480751539169204,111.79240234236785,0.11103690467765906,0.10537559266860094,0.22222861085556578,11.473776625858044,0.025475904040761443,1.9882262401811621,14.526594897742553,0.48609882527775811,997.76931038143096,1.1632890453612623,33.005073066308114,0.94097197650555531,0.37366870709786992,12.156517585450429,0.033282322553251718,1.7894168848630669,0.039253237562805181,8.5486032481777663,0.018730981529969572,0.20323225532517164,0.47440025475904046,2.2531800651050879,0.012804295520486873,0.13624743471799589,84.752782004104446,2.8830010261128018,0.14642010473427217,190.02479035453968,0.29836883447739021,0.43835361970136583,4.2558691883093909,20.516506262826407,1.5335521194536836,1.7201984997523179,0.039253237562805181,0.038501344561602154,6.6535675111457087,0.096286533154058454],"y":[0.0094511844526218945,0.0040248390064397425,530.12615354760806,0.06781135004599817,0.1289565604875805,0.013871320147194112,0.0038990627874885006,0.020699172033118676,0.059851512189512422,29.94455065547378,8.7938060602575909,80.037139920653175,0.023807641444342227,0.051981514489420427,0.078466392594296233,0.73340113270469187,0.31429680312787495,5.5133466536338549,0.29481945722171116,0.16769563592456302,0.10107017594296229,0.02546070032198712,1.2816956071757131,0.041488184222631098,0.32960556577736894,0.021597573597056118,0.1002616145354186,0.31638109475620979,0.59546055657773689,0.064792720791168365,0.048747268859245629,0.19700149494020239,0.64271647884084637,0.0026233325666973322,1.9033894894204231,0.2804989362925483,0.17495472056117756,0.014949402023919044,8.8717873160073601,0.0049771446642134318,0.22044977575896965,0.32877903633854644,0.54971394894204229,0.0058396101655933761,0.32150198367065319,2.1058532658693654,0.046860625574977006,441.68152023919049,0.024202938132474702,4.2323338316467343,0.048621492640294389,0.22695420308187675,0.92776132704691816,0.031731543238270474,0.053293180772769094,0.052340875114995397,1.5241382532198713,0.0179859993100276,0.13756324747010121,0.049897222861085555,0.37053674103035877,0.017680542778288868,0.014949402023919044,14.144074862005521,0.57188649954001836,0.071207307957681695,24.458982578196874,0.049735510579576821,0.16631209751609938,0.085833285418583261,1.019344382474701,0.041398344066237353,1.5545760982060719,0.0017249310027598896,0.024059193882244711,1.1422277483900645,0.0044920078196872123],"mode":"markers","text":["Amnat Charoen","Ang Thong","Bangkok","Bueng Kan","Buriram","Chachoengsao","Chainat","Chaiyaphum","Chanthaburi","Chiang Mai","Chiang Rai","Chonburi","Chumphon","Kalasin","Kamphaeng Phet","Kanchanaburi","Khon Kaen","Krabi","Lampang","Lamphun","Loei","Lopburi","Mae Hong Son","Maha Sarakham","Mukdahan","Nakhon Nayok","Nakhon Pathom","Nakhon Phanom","Nakhon Ratchasima","Nakhon Sawan","Nakhon Si Thammarat","Nan","Narathiwat","Nong Bua Lamphu","Nong Khai","Nonthaburi","Pathum Thani","Pattani","Phang Nga","Phatthalung","Phayao","Phetchabun","Phetchaburi","Phichit","Phitsanulok","Phra Nakhon Si Ayutthaya","Phrae","Phuket","Prachinburi","Prachuap Khiri Khan","Ranong","Ratchaburi","Rayong","Roi Et","Sa Kaeo","Sakon Nakhon","Samut Prakan","Samut Sakhon","Samut Songkhram","Saraburi","Satun","Sing Buri","Sisaket","Songkhla","Sukhothai","Suphan Buri","Surat Thani","Surin","Tak","Trang","Trat","Ubon Ratchathani","Udon Thani","Uthai Thani","Uttaradit","Yala","Yasothon"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The top 3 provinces are the same for both, but there are differences further down the list.</p>
</section>
<section id="c.2-number-of-tourists" class="level2">
<h2 class="anchored" data-anchor-id="c.2-number-of-tourists">C.2 Number of Tourists</h2>
<p>The next measure we can look at is the number of tourists. We produce a similar line chart as we did for tourism revenue with the code chunk below. We display the number of tourists in thousands.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the data to just the required indicators</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>aggregated_data <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"no_tourist_all"</span>, <span class="st">"no_tourist_thai"</span>, <span class="st">"no_tourist_foreign"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MonthYear, Indicator) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalValue =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'MonthYear'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the line chart</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aggregated_data, <span class="fu">aes</span>(<span class="at">x =</span> MonthYear, <span class="at">y =</span> TotalValue, <span class="at">color =</span> Indicator, <span class="at">group =</span> Indicator)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Thailand Number of Tourists by Month"</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tourists, Thousands"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month-Year"</span>) <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"no_tourist_all"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"no_tourist_thai"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"no_tourist_foreign"</span> <span class="ot">=</span> <span class="st">"red"</span>))</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot chart to an interactive plotly chart</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(p)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the interactive plot</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>interactive_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a77ad32f6b82562872f5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a77ad32f6b82562872f5">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[28609.150000000001,25658.219000000001,25892.424999999999,26216.826000000001,24572.348000000002,22914.989000000001,24064.028999999999,23045.161,22694.598999999998,26728.810000000001,27194.342000000001,29551.092000000001,27877.866999999998,18051.790000000001,7221.3549999999996,304.12200000000001,735.77599999999995,4536.076,10052.505999999999,11234.164000000001,11436.148999999999,13811.576999999999,16441.773000000001,15326.957,6849.933,8929.9130000000005,10876.096,7052.9089999999997,1411.184,1324.47,912.423,936.04100000000005,2257.4319999999998,4696.7539999999999,11457.055,16332.360000000001,15864.753000000001,15720.389999999999,15929.546,17362.379000000001,16893.646000000001,17123.179,18767.727999999999,18959.299999999999,19107.814999999999,20454.535,22691.134999999998,25967.362000000001,26798.237000000001,25516.021000000001],"text":["MonthYear: 2019-01<br />TotalValue: 28609.150<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-02<br />TotalValue: 25658.219<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-03<br />TotalValue: 25892.425<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-04<br />TotalValue: 26216.826<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-05<br />TotalValue: 24572.348<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-06<br />TotalValue: 22914.989<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-07<br />TotalValue: 24064.029<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-08<br />TotalValue: 23045.161<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-09<br />TotalValue: 22694.599<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-10<br />TotalValue: 26728.810<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-11<br />TotalValue: 27194.342<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2019-12<br />TotalValue: 29551.092<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-01<br />TotalValue: 27877.867<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-02<br />TotalValue: 18051.790<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-03<br />TotalValue:  7221.355<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-04<br />TotalValue:   304.122<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-05<br />TotalValue:   735.776<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-06<br />TotalValue:  4536.076<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-07<br />TotalValue: 10052.506<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-08<br />TotalValue: 11234.164<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-09<br />TotalValue: 11436.149<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-10<br />TotalValue: 13811.577<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-11<br />TotalValue: 16441.773<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2020-12<br />TotalValue: 15326.957<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-01<br />TotalValue:  6849.933<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-02<br />TotalValue:  8929.913<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-03<br />TotalValue: 10876.096<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-04<br />TotalValue:  7052.909<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-05<br />TotalValue:  1411.184<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-06<br />TotalValue:  1324.470<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-07<br />TotalValue:   912.423<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-08<br />TotalValue:   936.041<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-09<br />TotalValue:  2257.432<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-10<br />TotalValue:  4696.754<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-11<br />TotalValue: 11457.055<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2021-12<br />TotalValue: 16332.360<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-01<br />TotalValue: 15864.753<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-02<br />TotalValue: 15720.390<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-03<br />TotalValue: 15929.546<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-04<br />TotalValue: 17362.379<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-05<br />TotalValue: 16893.646<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-06<br />TotalValue: 17123.179<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-07<br />TotalValue: 18767.728<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-08<br />TotalValue: 18959.300<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-09<br />TotalValue: 19107.815<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-10<br />TotalValue: 20454.535<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-11<br />TotalValue: 22691.135<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2022-12<br />TotalValue: 25967.362<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2023-01<br />TotalValue: 26798.237<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all","MonthYear: 2023-02<br />TotalValue: 25516.021<br />Indicator: no_tourist_all<br />Indicator: no_tourist_all"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,0,255,1)","dash":"solid"},"hoveron":"points","name":"no_tourist_all","legendgroup":"no_tourist_all","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[7907.1220000000003,7189.1859999999997,7139.4709999999995,6947.5799999999999,6078.7700000000004,5881.2979999999998,5894.5110000000004,5912.9470000000001,5584.0770000000002,5792.3209999999999,5887.634,7178.1130000000003,7976.1639999999998,3882.7939999999999,936.78099999999995,173.887,163.83000000000001,113.89,85.204999999999998,81.361000000000004,86.134,91.793000000000006,127.98399999999999,95.468000000000004,59.945,63.887,76.543999999999997,70.338999999999999,37.390999999999998,32.435000000000002,43.174999999999997,42.475999999999999,59.094999999999999,100.527,185.73599999999999,382.73899999999998,457.83800000000002,455.709,554.11699999999996,641.21699999999998,1041.7929999999999,1414.232,2030.1300000000001,2244.8119999999999,2279.0650000000001,2758.8029999999999,3637.924,4353.607,4978.6090000000004,5399.116],"text":["MonthYear: 2019-01<br />TotalValue:  7907.122<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-02<br />TotalValue:  7189.186<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-03<br />TotalValue:  7139.471<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-04<br />TotalValue:  6947.580<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-05<br />TotalValue:  6078.770<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-06<br />TotalValue:  5881.298<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-07<br />TotalValue:  5894.511<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-08<br />TotalValue:  5912.947<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-09<br />TotalValue:  5584.077<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-10<br />TotalValue:  5792.321<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-11<br />TotalValue:  5887.634<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2019-12<br />TotalValue:  7178.113<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-01<br />TotalValue:  7976.164<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-02<br />TotalValue:  3882.794<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-03<br />TotalValue:   936.781<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-04<br />TotalValue:   173.887<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-05<br />TotalValue:   163.830<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-06<br />TotalValue:   113.890<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-07<br />TotalValue:    85.205<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-08<br />TotalValue:    81.361<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-09<br />TotalValue:    86.134<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-10<br />TotalValue:    91.793<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-11<br />TotalValue:   127.984<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2020-12<br />TotalValue:    95.468<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-01<br />TotalValue:    59.945<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-02<br />TotalValue:    63.887<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-03<br />TotalValue:    76.544<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-04<br />TotalValue:    70.339<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-05<br />TotalValue:    37.391<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-06<br />TotalValue:    32.435<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-07<br />TotalValue:    43.175<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-08<br />TotalValue:    42.476<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-09<br />TotalValue:    59.095<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-10<br />TotalValue:   100.527<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-11<br />TotalValue:   185.736<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2021-12<br />TotalValue:   382.739<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-01<br />TotalValue:   457.838<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-02<br />TotalValue:   455.709<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-03<br />TotalValue:   554.117<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-04<br />TotalValue:   641.217<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-05<br />TotalValue:  1041.793<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-06<br />TotalValue:  1414.232<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-07<br />TotalValue:  2030.130<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-08<br />TotalValue:  2244.812<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-09<br />TotalValue:  2279.065<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-10<br />TotalValue:  2758.803<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-11<br />TotalValue:  3637.924<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2022-12<br />TotalValue:  4353.607<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2023-01<br />TotalValue:  4978.609<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign","MonthYear: 2023-02<br />TotalValue:  5399.116<br />Indicator: no_tourist_foreign<br />Indicator: no_tourist_foreign"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","name":"no_tourist_foreign","legendgroup":"no_tourist_foreign","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[20702.027999999998,18469.032999999999,18752.954000000002,19269.245999999999,18493.578000000001,17033.690999999999,18169.518,17132.214,17110.522000000001,20936.489000000001,21306.707999999999,22372.978999999999,19901.703000000001,14168.995999999999,6284.5739999999996,130.23500000000001,571.94600000000003,4422.1859999999997,9967.3009999999995,11152.803,11350.014999999999,13719.784,16313.789000000001,15231.489,6789.9880000000003,8866.0259999999998,10799.552,6982.5699999999997,1373.7929999999999,1292.0350000000001,869.24800000000005,893.56500000000005,2198.337,4596.2269999999999,11271.319,15949.620999999999,15406.915000000001,15264.681,15375.429,16721.162,15851.852999999999,15708.947,16737.598000000002,16714.488000000001,16828.75,17695.732,19053.210999999999,21613.755000000001,21819.628000000001,20116.904999999999],"text":["MonthYear: 2019-01<br />TotalValue: 20702.028<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-02<br />TotalValue: 18469.033<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-03<br />TotalValue: 18752.954<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-04<br />TotalValue: 19269.246<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-05<br />TotalValue: 18493.578<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-06<br />TotalValue: 17033.691<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-07<br />TotalValue: 18169.518<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-08<br />TotalValue: 17132.214<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-09<br />TotalValue: 17110.522<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-10<br />TotalValue: 20936.489<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-11<br />TotalValue: 21306.708<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2019-12<br />TotalValue: 22372.979<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-01<br />TotalValue: 19901.703<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-02<br />TotalValue: 14168.996<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-03<br />TotalValue:  6284.574<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-04<br />TotalValue:   130.235<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-05<br />TotalValue:   571.946<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-06<br />TotalValue:  4422.186<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-07<br />TotalValue:  9967.301<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-08<br />TotalValue: 11152.803<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-09<br />TotalValue: 11350.015<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-10<br />TotalValue: 13719.784<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-11<br />TotalValue: 16313.789<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2020-12<br />TotalValue: 15231.489<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-01<br />TotalValue:  6789.988<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-02<br />TotalValue:  8866.026<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-03<br />TotalValue: 10799.552<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-04<br />TotalValue:  6982.570<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-05<br />TotalValue:  1373.793<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-06<br />TotalValue:  1292.035<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-07<br />TotalValue:   869.248<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-08<br />TotalValue:   893.565<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-09<br />TotalValue:  2198.337<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-10<br />TotalValue:  4596.227<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-11<br />TotalValue: 11271.319<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2021-12<br />TotalValue: 15949.621<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-01<br />TotalValue: 15406.915<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-02<br />TotalValue: 15264.681<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-03<br />TotalValue: 15375.429<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-04<br />TotalValue: 16721.162<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-05<br />TotalValue: 15851.853<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-06<br />TotalValue: 15708.947<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-07<br />TotalValue: 16737.598<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-08<br />TotalValue: 16714.488<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-09<br />TotalValue: 16828.750<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-10<br />TotalValue: 17695.732<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-11<br />TotalValue: 19053.211<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2022-12<br />TotalValue: 21613.755<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2023-01<br />TotalValue: 21819.628<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai","MonthYear: 2023-02<br />TotalValue: 20116.905<br />Indicator: no_tourist_thai<br />Indicator: no_tourist_thai"],"type":"scatter","mode":"lines","line":{"width":3.7795275590551185,"color":"rgba(0,255,0,1)","dash":"solid"},"hoveron":"points","name":"no_tourist_thai","legendgroup":"no_tourist_thai","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":69.406392694063939,"l":54.794520547945211},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Thailand Number of Tourists by Month","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,50.600000000000001],"tickmode":"array","ticktext":["2019-01","2019-02","2019-03","2019-04","2019-05","2019-06","2019-07","2019-08","2019-09","2019-10","2019-11","2019-12","2020-01","2020-02","2020-03","2020-04","2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02"],"tickvals":[1,2,3,3.9999999999999996,5,6,7,8,9,10,11,12,13.000000000000002,14,15,16,17,18,19,20,21,22,23,24,25,26,27,27.999999999999996,29.000000000000004,30.000000000000004,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"categoryorder":"array","categoryarray":["2019-01","2019-02","2019-03","2019-04","2019-05","2019-06","2019-07","2019-08","2019-09","2019-10","2019-11","2019-12","2020-01","2020-02","2020-03","2020-04","2020-05","2020-06","2020-07","2020-08","2020-09","2020-10","2020-11","2020-12","2021-01","2021-02","2021-03","2021-04","2021-05","2021-06","2021-07","2021-08","2021-09","2021-10","2021-11","2021-12","2022-01","2022-02","2022-03","2022-04","2022-05","2022-06","2022-07","2022-08","2022-09","2022-10","2022-11","2022-12","2023-01","2023-02"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Month-Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1443.4978500000002,31027.024850000002],"tickmode":"array","ticktext":["0","10000","20000","30000"],"tickvals":[0,10000,20000,30000],"categoryorder":"array","categoryarray":["0","10000","20000","30000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Tourists, Thousands","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Indicator","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"a05c2a336a10":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"a05c2a336a10","visdat":{"a05c2a336a10":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The trend for the total follows the same general movement as the chart for revenue, however, it looks like tourist numbers are primarily driven by locals than foreigners.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>